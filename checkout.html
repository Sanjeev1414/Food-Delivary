<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - SS Food Court</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="restaurant.html" class="logo">üçî SS Food Court</a>
            <nav class="nav-links">
                <a href="restaurant.html">Home</a>
                <a href="cart.html">Cart (<span id="cart-count">0</span>)</a>
                <a href="orderHistory.html">Orders</a>
            </nav>
        </div>
    </header>

    <div class="container">
        <h1 style="margin: 30px 0; color: #333;">Checkout</h1>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
            <div>
                <div class="card">
                    <h2 style="color: #fc8019; margin-bottom: 20px;">Delivery Address</h2>
                    <form id="checkoutForm">
                        <div class="form-group">
                            <label for="name">Full Name</label>
                            <input type="text" id="name" name="name" required placeholder="Enter your name">
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone Number</label>
                            <input type="tel" id="phone" name="phone" required placeholder="Enter your phone">
                        </div>
                        <div class="form-group">
                            <label for="address">Address</label>
                            <input type="text" id="address" name="address" required placeholder="Street address">
                        </div>
                        <div class="form-group">
                            <label for="city">City</label>
                            <input type="text" id="city" name="city" required placeholder="Enter city">
                        </div>
                        <div class="form-group">
                            <label for="pincode">Pincode</label>
                            <input type="text" id="pincode" name="pincode" required placeholder="Enter pincode">
                        </div>
                    </form>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2 style="color: #fc8019; margin-bottom: 20px;">Payment Method</h2>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="radio" name="payment" value="cash" checked style="width: auto;">
                            <span>Cash on Delivery</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="radio" name="payment" value="card" style="width: auto;">
                            <span>Credit/Debit Card</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="radio" name="payment" value="upi" style="width: auto;">
                            <span>UPI</span>
                        </label>
                    </div>
                </div>
            </div>

            <div>
                <div class="card">
                    <h2 style="color: #fc8019; margin-bottom: 20px;">Order Summary</h2>
                    <div id="order-items">
                        <!-- Order items will be shown here -->
                    </div>
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #eee;">
                        <div class="summary-row">
                            <span>Subtotal</span>
                            <span id="subtotal">‚Çπ0</span>
                        </div>
                        <div class="summary-row">
                            <span>Delivery Fee</span>
                            <span>‚Çπ40</span>
                        </div>
                        <div class="summary-row">
                            <span>Tax</span>
                            <span id="tax">‚Çπ0</span>
                        </div>
                        <div class="summary-row total">
                            <span>Total</span>
                            <span id="total">‚Çπ0</span>
                        </div>
                    </div>
                    <button type="submit" form="checkoutForm" class="checkout-btn">Place Order</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        function renderOrderSummary() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const orderItemsContainer = document.getElementById('order-items');

            if (cart.length === 0) {
                window.location.href = 'cart.html';
                return;
            }

            orderItemsContainer.innerHTML = '';
            cart.forEach(item => {
                const orderItem = document.createElement('div');
                orderItem.style.cssText = 'display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee;';
                orderItem.innerHTML = `
                    <span>${item.name} x ${item.quantity}</span>
                    <span>‚Çπ${item.price * item.quantity}</span>
                `;
                orderItemsContainer.appendChild(orderItem);
            });

            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.05;
            const deliveryFee = 40;
            const total = subtotal + tax + deliveryFee;

            document.getElementById('subtotal').textContent = `‚Çπ${subtotal}`;
            document.getElementById('tax').textContent = `‚Çπ${Math.round(tax)}`;
            document.getElementById('total').textContent = `‚Çπ${Math.round(total)}`;
        }

        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }

            // Generate order ID
            const orderId = 'ORD' + Date.now();
            const orderDate = new Date().toLocaleString();
            const estimatedTime = Math.floor(Math.random() * 15) + 25; // 25-40 minutes

            // Save order to history
            let orderHistory = JSON.parse(localStorage.getItem('orderHistory')) || [];
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.05;
            const total = Math.round(subtotal + tax + 40);

            orderHistory.unshift({
                orderId: orderId,
                date: orderDate,
                items: cart.map(item => ({
                    name: item.name,
                    quantity: item.quantity,
                    price: item.price
                })),
                total: total,
                status: 'Delivered'
            });
            localStorage.setItem('orderHistory', JSON.stringify(orderHistory));

            // Store order info for success page
            localStorage.setItem('lastOrder', JSON.stringify({
                orderId: orderId,
                estimatedTime: estimatedTime,
                total: total
            }));

            // Clear cart
            clearCart();

            // Redirect to success page
            window.location.href = 'orderInformation.html';
        });

        document.addEventListener('DOMContentLoaded', function() {
            renderOrderSummary();
        });
    </script>
</body>
</html>

